<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç Frontend</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        input[type="url"] { width: 300px; padding: 10px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
        .loading { display: none; color: #666; }
        .results { display: none; margin-top: 20px; padding: 20px; background: #f8f9fa; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>–¢–µ—Å—Ç Frontend Accessibility Evaluator</h1>
    
    <form id="testForm">
        <div class="form-group">
            <label for="url">URL –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:</label><br>
            <input type="url" id="url" value="https://example.com" required>
        </div>
        <button type="submit" id="submitBtn">–¢–µ—Å—Ç—É–≤–∞—Ç–∏</button>
    </form>
    
    <div id="loading" class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
    <div id="results" class="results"></div>
    
    <script>
        function formatKeyboardDetails(keyboardData) {
            if (!keyboardData) {
                return '<p>‚ùå –î–∞–Ω—ñ –ø—Ä–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–Ω—É –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ</p>';
            }
            
            let html = `
                <p><strong>üìä –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</strong></p>
                <ul>
                    <li>–î–æ—Å—Ç—É–ø–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤: ${keyboardData.accessible_elements || 0}</li>
                    <li>–ó–∞–≥–∞–ª—å–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤: ${keyboardData.total_elements || 0}</li>
                    <li>–ü–æ—è—Å–Ω–µ–Ω–Ω—è —Å–∫–æ—Ä—É: ${keyboardData.score_explanation || '–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'}</li>
                </ul>
            `;
            
            // –î–æ—Å—Ç—É–ø–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏
            if (keyboardData.accessible_elements_list && keyboardData.accessible_elements_list.length > 0) {
                html += `
                    <p><strong>‚úÖ –î–æ—Å—Ç—É–ø–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ (${keyboardData.accessible_elements_list.length}):</strong></p>
                    <ul>
                `;
                keyboardData.accessible_elements_list.forEach((element, index) => {
                    html += `
                        <li>
                            <strong>–°–µ–ª–µ–∫—Ç–æ—Ä:</strong> ${element.selector || '–Ω–µ–≤—ñ–¥–æ–º–æ'}<br>
                            <strong>–ü—Ä–∞–≤–∏–ª–æ:</strong> ${element.rule || '–Ω–µ–≤—ñ–¥–æ–º–æ'}<br>
                            <strong>–°—Ç–∞—Ç—É—Å:</strong> ${element.status || '–î–æ—Å—Ç—É–ø–Ω–∏–π –∑ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏'}<br>
                            <strong>HTML:</strong> <code>${(element.html || '').substring(0, 100)}${element.html && element.html.length > 100 ? '...' : ''}</code>
                        </li>
                    `;
                });
                html += '</ul>';
            }
            
            // –ü—Ä–æ–±–ª–µ–º–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏
            if (keyboardData.problematic_elements && keyboardData.problematic_elements.length > 0) {
                html += `
                    <p><strong>‚ùå –ü—Ä–æ–±–ª–µ–º–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ (${keyboardData.problematic_elements.length}):</strong></p>
                    <ul>
                `;
                keyboardData.problematic_elements.forEach((element, index) => {
                    html += `
                        <li>
                            <strong>–°–µ–ª–µ–∫—Ç–æ—Ä:</strong> ${element.selector || '–Ω–µ–≤—ñ–¥–æ–º–æ'}<br>
                            <strong>–ü—Ä–∞–≤–∏–ª–æ:</strong> ${element.rule || '–Ω–µ–≤—ñ–¥–æ–º–æ'}<br>
                            <strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> ${element.issue || '–ü—Ä–æ–±–ª–µ–º–∞ –∑ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–Ω–æ—é –Ω–∞–≤—ñ–≥–∞—Ü—ñ—î—é'}<br>
                            <strong>HTML:</strong> <code>${(element.html || '').substring(0, 100)}${element.html && element.html.length > 100 ? '...' : ''}</code>
                        </li>
                    `;
                });
                html += '</ul>';
            }
            
            if (keyboardData.accessible_elements === 0 && keyboardData.total_elements === 0) {
                html += '<p>‚ö†Ô∏è –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –¥–ª—è –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–Ω–æ—ó –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</p>';
            }
            
            return html;
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DOM –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ');
            
            const form = document.getElementById('testForm');
            const urlInput = document.getElementById('url');
            const submitBtn = document.getElementById('submitBtn');
            const loadingDiv = document.getElementById('loading');
            const resultsDiv = document.getElementById('results');
            
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                console.log('üìù –§–æ—Ä–º–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∞');
                
                const url = urlInput.value.trim();
                console.log('üîó URL:', url);
                
                // –ü–æ–∫–∞–∑–∞—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
                loadingDiv.style.display = 'block';
                resultsDiv.style.display = 'none';
                submitBtn.disabled = true;
                
                try {
                    console.log('üì° –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∑–∞–ø–∏—Ç...');
                    
                    const response = await fetch('http://localhost:8001/api/evaluate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Accept': 'application/json'
                        },
                        body: JSON.stringify({ url: url })
                    });
                    
                    console.log('üì® –°—Ç–∞—Ç—É—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:', response.status);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    const data = await response.json();
                    console.log('üìä –û—Ç—Ä–∏–º–∞–Ω—ñ –¥–∞–Ω—ñ:', data);
                    
                    // –ü–æ–∫–∞–∑–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
                    resultsDiv.innerHTML = `
                        <h3>‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑—É</h3>
                        <p><strong>URL:</strong> ${data.url}</p>
                        <p><strong>–°–∫–æ—Ä:</strong> ${(data.final_score * 100).toFixed(1)}%</p>
                        <p><strong>–†—ñ–≤–µ–Ω—å:</strong> ${data.quality_level}</p>
                        <p><strong>–û–ø–∏—Å:</strong> ${data.quality_description}</p>
                        
                        <h4>–ü—ñ–¥—Å–∫–æ—Ä–∏:</h4>
                        <ul>
                            <li>–ü–µ—Ä—Ü–µ–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å: ${(data.subscores.perceptibility * 100).toFixed(1)}%</li>
                            <li>–ö–µ—Ä–æ–≤–∞–Ω—ñ—Å—Ç—å: ${(data.subscores.operability * 100).toFixed(1)}%</li>
                            <li>–ó—Ä–æ–∑—É–º—ñ–ª—ñ—Å—Ç—å: ${(data.subscores.understandability * 100).toFixed(1)}%</li>
                            <li>–õ–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—è: ${(data.subscores.localization * 100).toFixed(1)}%</li>
                        </ul>
                        
                        <h4>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó (${data.recommendations.length}):</h4>
                        <ul>
                            ${data.recommendations.map(rec => `<li>${rec.category}: ${rec.recommendation}</li>`).join('')}
                        </ul>
                        
                        <h4>–î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–Ω–æ—ó –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó:</h4>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                            ${formatKeyboardDetails(data.detailed_analysis?.keyboard_navigation)}
                        </div>
                    `;
                    resultsDiv.style.display = 'block';
                    
                } catch (error) {
                    console.error('‚ùå –ü–æ–º–∏–ª–∫–∞:', error);
                    resultsDiv.innerHTML = `<div class="error">‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}</div>`;
                    resultsDiv.style.display = 'block';
                } finally {
                    loadingDiv.style.display = 'none';
                    submitBtn.disabled = false;
                }
            });
        });
    </script>
</body>
</html>